\documentclass[a4paper]{article}

\usepackage[top=.5in, bottom=.5in, left=.75in, right=.75in]{geometry}

\input{others/preamble.tex}

\newcommand{\authornote}[3]{{\color{#2} {\sc #1}: #3}}
\newcommand\bruno[1]{\authornote{bruno}{red}{#1}}
\newcommand\george[1]{\authornote{george}{blue}{#1}}
\newcommand\haoyuan[1]{\authornote{bruno}{green}{#1}}

% Define macros immediately before the \begin{document} command
\input{macros/common_pl_macros.tex}

\input{f-and/base.tex}
\input{f-and/orthogonality.tex}
\input{f-and/wellformedness.tex}
\input{f-and/subtyping.tex}
\input{f-and/select.tex}
\input{f-and/restrict.tex}
\input{f-and/typing.tex}

\input{algebra/syntax.tex}

\begin{document}

\section{Syntax}

\subsection{Source Syntax}

\begin{displaymath}
    \begin{array}{l}
      \begin{array}{llrl}
        \text{Types}
        & T & \Coloneqq & \alpha \mid \top \mid \tau_1 \to \tau_2 \mid \for \alpha \tau \mid \tau_1 \andop \tau_2 \mid \recty l \tau \\
        \text{Expressions}
        & E & \Coloneqq & x \mid \top \mid \lam x \tau e \mid \app {e_1} {e_2} \mid \blam \alpha e \mid \tapp e \tau \mid e_1 \mergeop e_2 \mid \reccon l e \mid e.l \mid e \restrictop l \\
        &   & \mid & \sig s \alpha l \tau e \\
        &   & \mid & \sigext {s_1} {\alpha_1} {s_2} \alpha l \tau e \\
        &   & \mid & \alg x s \tau l {l_1} {x_1} {e_1} e \\
        &   & \mid & \algext x {x_0} s \tau l {l_1} {x_1} {e_1} e \\
        &   & \mid & \data d s \alpha {\alpha_0} e \\
        \text{Contexts} & \Gamma & \Coloneqq & \epsilon \mid \Gamma, \alpha \mid \Gamma, x \hast \tau \mid \Gamma, s {[} \overline{\alpha} {]}\to\overline{l:\tau} \\
        \text{Labels} & l &  & \text{(fields)} \\
        & s &  & \text{(interfaces)} \\
        & d &  & \text{(datatypes)}\\
        \text{Syntactic sugars} & \circ & \Coloneqq & s[\alpha_0] \\
        & \bullet & \Coloneqq & [\overline{\alpha_0}/\overline{\alpha}]\{\overline{l:\tau}\}
      \end{array}
    \end{array}
\end{displaymath}

\subsection{Target Syntax}

\begin{displaymath}
    \begin{array}{l}
      \begin{array}{llrl}
        \text{Types}
        & T & \Coloneqq & \alpha \mid \top \mid \tau_1 \to \tau_2 \mid \for \alpha \tau \mid \tau_1 \andop \tau_2 \mid \recty l \tau \\
        \text{Expressions}
        & E & \Coloneqq & x \mid \top \mid \lam x \tau e \mid \app {e_1} {e_2} \mid \blam \alpha e \mid \tapp e \tau \mid e_1 \mergeop e_2 \mid \reccon l e \mid e.l \mid e \restrictop l\\
        \text{Contexts} & \Gamma & \Coloneqq & \epsilon \mid \Gamma, \alpha \mid \Gamma, x \hast \tau \\
        \text{Labels} & l \\
        \text{Syntactic sugars} & \circ & \Coloneqq & \letexpr {x:\tau} {e_1} {e_2} \\
        & \bullet & \Coloneqq & \app {(\lam x \tau {e_2})} {e_1}
      \end{array}
    \end{array}
\end{displaymath}
  
\section{Translation}

\begin{mathpar}
    \framebox{$ \judgeewf \Gamma {e:\tau\Rightarrow E} $}

    \rulesig
    
    \rulesigext
    
    \rulealg
\end{mathpar}

\end{document}
